function KickWd(){"undefined"!=typeof BTN1&&BTN1.read()||E.kickWatchdog()}E.kickWatchdog();var wdint=setInterval(KickWd,2e3);E.enableWatchdog(15,!1);var SPI2=function(){var t=atob("AAAAAAAAAAAAAAAAAAAAAAAAAAD///////////////8QtQNMfEQigGCAoYDjgBC92P///wdLe0QbiUOxBEoTaAAr/NAAIxNgA0p6RBOBcEcYMQJAxv///7L///8t6fBHkEYZTBlO//fl/xlK3/hkwAAjASUTYE/w/w5TYKlGI2AQMh9G/ykA6wMKwvgAoIu//zMxYMb4AOAAIYi//znM+ACQuPEADwbQKbkLS3tEHYEAIL3o8IfU+ACguvEAD/rQJ2AAKd7R8+cYMQJASDUCQDQ1AkAQMAJAUP///y3p8E+bsM3pARJQSnpEBkaS+ACQACgA8JGAACkA8I6ACfH/MwcrAPKJgAEjA/oJ8wE727IDkwR4Q3iXiETqAyQCmxxB02gA8QILpLILsT1KE2BP6kkD27IEkz1Le0QRqAWTCKvN6QYwT/AACEFGBZsCnbP4AqADmwGaI0BE+gn0MvgTwAObI0BE+gn0MvgTIASbHUTtsgctQNiksk/qLBNDVBMSAfECDkPqDBxDGAMxqvECCiMpg/gBwB/6ivoA+A4gCd0BIv/3W//Y8QEIC78HmAaYQUYAIbrxAA/L0R1Le0QBP9uIHkS/snN4NHhE6gMkApscQQbxAguksgAvttHJsTpG//c8/xNLe0TYaBCxDUsYYAAgG7C96PCP3kYIPR74ATvtssXxCAsD+gvzHEOksvNGsuf/9w//5edP8P8w6ecAvwwFAFAIBQBQFP///8T+//9A/v//Fv7//xVKekRwtQ5GEWkFRuGxEEsZYNJoArEaYAAiASEoRv/3Af8OSwtMe0QBLhppImAE3QAicR5oHP/39f4JS3tE2GgIsSBgACBwvU/w/zD75wC/DAUAUAgFAFDC/f//nv3//4j9//8TtQAoHtsAKaa/jfgFEAIkASQAKqS/AqkJGY34BACkvwE0AfgELAAror8CqhIZATQhRgGoqL8C+AQ8//ev/yBGArAQvQAk+udwtQVGiLFGGAAkKEYQ+AEbGbFFGLVCAtlkQiBGcL3/95n/ACj50QE07+cERvXnAAA4tQ9Le0QaaZKxiLGBsdtoC7EJShNgC00ITH1EACIraSNg//eR/uhoCLEgYAAgOL1P8P8w++cAvwwFAFAIBQBQ5Pz//878//8PSjC1FGjEuQ5LG2gLsQ5MI2ARSw1Me0QABl1pJWCdaWVg3GkKS0kAHGBYYVlkByMTYAhLASAYYDC9T/D/MPvnADUCQAQzAkAIMwJACDUCQBA1AkAUMAJAivz//wVKACMTYKL1fnITYANLG2gLscL4ADJwRwA1AkAEMwJAELUGTHxExOkFAQEhAfoC8gH6A/PiYCNhEL0AvyD8//8=");return{cmd:E.nativeCall(569,"int(int,int)",t),cmds:E.nativeCall(741,"int(int,int)",t),cmd4:E.nativeCall(669,"int(int,int,int,int)",t),data:E.nativeCall(789,"int(int,int)",t),setpins:E.nativeCall(985,"void(int,int,int,int)",t),enable:E.nativeCall(861,"int(int,int)",t),disable:E.nativeCall(953,"void()",t),blit_setup:E.nativeCall(33,"void(int,int,int,int)",t),blt_pal:E.nativeCall(221,"int(int,int,int)",t)}}();E.kickWatchdog();var RST=D7,CS=D8,DC=D6,PWR=D11,SCK=D3,MOSI=D2;function toFlatString(t){var i=E.toString(t);return i||(print("toFlatString() fail&retry!"),E.defrag(),(i=E.toString(t))?i:(print("fail&retry again!"),E.defrag(),(i=E.toString(t))||print("failed!"),i))}function toFlatBuffer(t){return E.toArrayBuffer(toFlatString(t))}function cmd(t){var i=t.length;if(!i)return SPI2.cmd4(t,-1,-1,-1);if(2==i)return SPI2.cmd4(t[0],t[1],-1,-1);if(3==i)return SPI2.cmd4(t[0],t[1],t[2],-1);if(4==i)return SPI2.cmd4(t[0],t[1],t[2],t[3]);if(1==i)return SPI2.cmd4(t[0],-1,-1,-1);t=toFlatString(t);SPI2.cmd(E.getAddressOf(t,!0),t.length)}function cmds(t){t=toFlatString(t),t=SPI2.cmds(E.getAddressOf(t,!0),t.length);return t<0&&print("lcd_cmds: buffer mismatch, cnt="+t),t}function delayms(t){digitalPulse(DC,0,t),digitalPulse(DC,0,0)}function init(){cmd(17),delayms(10),cmd([177,1,8,5]),cmd([178,1,8,5]),cmd([179,1,8,5,5,8,5]),cmd([180,0]),cmd([192,40,8,4]),cmd([193,192]),cmd([194,13,0]),cmd([195,141,42]),cmd([196,141,238]),cmd([197,29]),cmd([54,200]),cmd([224,7,23,12,21,46,42,35,40,40,40,46,57,0,3,2,16]),cmd([225,6,33,13,23,53,48,42,45,44,41,49,59,0,2,3,18]),cmd([58,3])}CS.write(1),DC.write(1),RST.write(1),digitalPulse(RST,0,10),SPI2.setpins(SCK,MOSI,CS,DC),SPI2.disable(),SPI2.enable(128,0);var pal,bpp=4,g=Graphics.createArrayBuffer(80,160,bpp);switch(bpp){case 2:pal=Uint16Array([0,3840,240,15]);break;case 1:pal=Uint16Array([0,10,160,170,2560,2570,2640,2730,1365,1375,1525,1535,3925,3935,4085,4095]),g.sc=g.setColor,c1=pal[1],g.setColor=function(t){1<(t=Math.floor(t))?(pal[1]=pal[t],g.sc(1)):1==t?(pal[1]=c1,g.sc(1)):g.sc(t)};break;case 4:pal=Uint16Array([0,10,160,170,2560,2570,2640,2730,1365,1375,1525,1535,3925,3935,4085,4095])}g.winCmd=toFlatBuffer([5,42,0,0,0,0,5,43,0,0,0,0,1,44,0]),g.winA=E.getAddressOf(g.winCmd,!0),g.palA=E.getAddressOf(pal.buffer,!0),g.buffA=E.getAddressOf(g.buffer,!0),g.stride=g.getWidth()*bpp/8,g.flip=function(t){var i,e,n,A,a=g.getModified(!0);t&&(a={x1:0,y1:0,x2:this.getWidth()-1,y2:this.getHeight()-1}),void 0!==a&&(A=254&a.x1,e=(i=a.x2+2&254)-A,n=a.y2-a.y1+1,e<1||n<1?print("empty rect ",e,n):((t=g.winCmd)[3]=24+A,t[5]=23+i,t[9]=a.y1,t[11]=a.y2,SPI2.blit_setup(e,n,bpp,g.stride),A=(n=A*bpp)%8,a=g.buffA+(n-A)/8+a.y1*g.stride,SPI2.cmds(g.winA,t.length),SPI2.blt_pal(a,g.palA,A)))},g.lev=256,g.setBrightness=function(t){0<=t&&t<=256?this.lev=t:t=this.lev,this.isOn&&(0==(t=1-t/256)||1==t?digitalWrite:analogWrite)(PWR,t)},g.isOn=!1,g.on=function(){this.isOn||([DC,SCK,MOSI,RST,CS].forEach(t=>{t.mode("input_pullup"),t.mode("output")}),CS.write(1),DC.write(1),RST.write(1),SCK.write(0),MOSI.write(0),PWR.reset(),SPI2.enable(128,0),PWR.set(),init(),this.flip(!0),cmd(19),cmd(41),this.isOn=!0,this.setBrightness())},g.off=function(){this.isOn&&(cmd(40),cmd(16),PWR.set(),SPI2.disable(),[DC,SCK,MOSI,RST,CS].forEach(t=>{t.mode("analog")}),this.isOn=!1)},exports.getGraphics=()=>g,exports.setHRMPower=t=>{digitalWrite(D27,t?0:1)},exports.getHRMValue=()=>analogRead(D28);const VIB=D25;function vibon(t){analogWrite(VIB,t.i),setTimeout(viboff,t.on,t)}function viboff(t){analogWrite(VIB,0),1<t.c?(t.c--,setTimeout(vibon,t.off,t)):VIB.reset()}exports.vibrate=function(i,t,e,n){var A;for(analogWrite(VIB,.1);t--;){A=i,analogWrite(VIB,A);let t=Date.now()+e;for(;t>Date.now(););for(analogWrite(VIB,0),t=Date.now()+n;t>Date.now(););}},exports.battVolts=function(){return 4.2/.18*analogRead(D5)},exports.battLevel=function(t){return 4.1<=(t=t||battVolts())?100:t<=3.3?0:100*(t-3.3)/(4.1-3.3)};var fc=new SPI;function accRegRead(t){return fc.send([128|t,0],D18)[1]}function accWriteReg(t,i){fc.send([127&t,i],D18)}function accSetBit(t,i){accWriteReg(t,accRegRead(t)|1<<i)}function accResetBit(t,i){accWriteReg(t,accRegRead(t)&~(1<<i))}function accLowPowerMode(t){(t?accSetBit:accResetBit)(17,6)}D23.write(1),fc.setup({sck:D19,miso:D22,mosi:D20,mode:0}),fc.send([185],D23),D18.set(),D31.set(),exports.accCoords=()=>{var t=Int8Array(fc.send([130,0,0,0,0,0,0],D18).buffer,2);return{x:t[0],y:t[2],z:t[4]}};
